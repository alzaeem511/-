<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>حاسبة جرعات الأطفال – حفر الباطن</title>
  <style>
    body { font-family: 'Tahoma', sans-serif; margin: 20px; background: #f9f9f9; }
    header { text-align: center; margin-bottom: 20px; }
    header img { max-height: 100px; display: block; margin: 0 auto; }
    h1 { font-size: 22px; margin-top: 10px; color: #003366; }
    .calc-box { background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    label { display: block; margin: 8px 0 4px; font-weight: bold; }
    input, select { padding: 6px; width: 100%; margin-bottom: 12px; }
    button { padding: 10px 20px; background: #0066cc; color: #fff; border: none; border-radius: 5px; cursor: pointer; }
    button:hover { background: #004999; }
    #result { margin-top: 20px; padding: 15px; background: #eef; border-radius: 8px; display:none; }
    footer { margin-top: 30px; text-align: center; font-size: 12px; color: #666; }
  </style>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#003366">
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js');
}
</script>

</head>
<body>

<header>
  <img src="https://hrhc2025.com/public/ar_assets/img/logo2.png" alt="شعار تجمع حفر الباطن الصحي">
  <h1>إدارة الرعاية الصيدلانية – مستشفى حفر الباطن المركزي</h1>
</header>

<div class="calc-box">
  <label>وزن الطفل (كجم):</label>
  <input type="number" id="weight" min="1" placeholder="أدخل الوزن بالكيلوجرام">

  <label>العمر (بالأشهر):</label>
  <input type="number" id="age" min="0" placeholder="أدخل العمر بالأشهر">

  <label>اختر الدواء:</label>
  <select id="drug">
    <option value="paracetamol">باراسيتامول (Adol)</option>
    <option value="ibuprofen">إيبوبروفين (Brufen)</option>
  </select>

  <label>اختر الشكل الدوائي:</label>
  <select id="form">
    <option value="syrup">شراب</option>
    <option value="supp">تحاميل</option>
</select>

  <label>تركيز المستحضر (ملغم/مل):</label>
  <select id="strength">
    <option value="32">160mg/5mL (32 mg/mL)</option>
    <option value="24">120mg/5mL (24 mg/mL)</option>
    <option value="20">100mg/5mL (20 mg/mL)</option>
    <option value="50">250mg/5mL (50 mg/mL)</option>
    <option value="20i">100mg/5mL Ibuprofen (20 mg/mL)</option>
    <option value="40i">200mg/5mL Ibuprofen (40 mg/mL)</option>
    <option value="40dropsi">40mg/mL Ibuprofen drops</option>
      <option value="125supp">125mg تحاميل أدول</option>
</select>

  <button onclick="calcDose()">احسب الجرعة الآمنة</button>

  <div id="result"></div>
</div>

<footer>
  <p>المصدر: Micromedex</p>
</footer>


<script>
function calcDose(){
  let weight = parseFloat(document.getElementById('weight').value);
  let age = parseInt(document.getElementById('age').value);
  let drug = document.getElementById('drug').value;
  let form = document.getElementById('form').value;
  let strengthVal = document.getElementById('strength').value;

  if (!weight || !age) {
    alert("الرجاء إدخال وزن وعمر صحيحين.");
    return;
  }

  // Micromedex: Paracetamol 10–15 mg/kg/dose q4–6h; max 75 mg/kg/day
  let doseMin, doseMax, freq, max24h;
  if (drug === "paracetamol") {
    doseMin = 10 * weight;
    doseMax = 15 * weight;
    freq = "كل 4-6 ساعات (بحد أقصى 5 جرعات/يوم)";
    max24h = 75 * weight;
  } else if (drug === "ibuprofen") {
    if (age < 6) {
      alert("⚠️ لا ينصح باستخدام الإيبوبروفين للأطفال أقل من 6 أشهر إلا بأمر الطبيب.");
    }
    doseMin = 5 * weight;
    doseMax = 10 * weight;
    freq = "كل 6-8 ساعات";
    max24h = 40 * weight;
    if (doseMax > 400) doseMax = 400;
  }

  let result = "<h3>النتيجة:</h3>";
  if (form === "syrup"){
    let mgPerMl = parseFloat(strengthVal);
    if (isNaN(mgPerMl)) {
      result += "اختر تركيز الشراب الصحيح من القائمة.<br>";
    } else {
      let mlMin = (doseMin / mgPerMl).toFixed(1);
      let mlMax = (doseMax / mgPerMl).toFixed(1);
      result += "الجرعة: " + doseMin.toFixed(0) + " – " + doseMax.toFixed(0) + " ملغم (" + mlMin + " – " + mlMax + " mL) " + freq + "<br>";
    }
  } else if (form === "supp") {
    if (drug !== "paracetamol") {
      result += "التحاميل المتاحة هي أدول (باراسيتامول) 125mg فقط.<br>";
    }
    if (strengthVal !== "125supp") {
      result += "اختر: 125mg تحاميل أدول من قائمة التركيزات.<br>";
    } else {
      let suppStrength = 125; // mg per suppository
      let suppMin = Math.ceil(doseMin / suppStrength);
      let suppMax = Math.ceil(doseMax / suppStrength);
      result += "الجرعة: " + doseMin.toFixed(0) + " – " + doseMax.toFixed(0) + " ملغم (" + suppMin + " – " + suppMax + " تحاميل) " + freq + "<br>";
    }
  } else {
    result += "الجرعة: " + doseMin.toFixed(0) + " – " + doseMax.toFixed(0) + " ملغم " + freq + "<br>";
  }

  result += "الحد الأقصى خلال 24 ساعة: " + max24h.toFixed(0) + " ملغم.<br>";
  document.getElementById('result').innerHTML = result;
  document.getElementById('result').style.display = 'block';
}
</script>


</body>
</html>